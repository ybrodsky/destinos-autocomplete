"use strict";angular.module("destinos-autocomplete",["ng","ngResource","ui.bootstrap","Gdo"]).factory("ApiDestinos",function($resource){return $resource(destinos_url+"/api",{},{autocompleteFull:{url:destinos_url+"/api/cities/autocomplete/full",method:"GET",headers:{ajaxLoader:!1},withCredentials:!1,isArray:!0},cities:{url:destinos_url+"/api/cities/autocomplete",method:"GET",headers:{ajaxLoader:!1},withCredentials:!1,isArray:!0},countries:{url:destinos_url+"/api/countries/autocomplete",method:"GET",headers:{ajaxLoader:!1},withCredentials:!1,isArray:!0},airports:{url:destinos_url+"/api/airports/autocomplete",method:"GET",headers:{ajaxLoader:!1},withCredentials:!1,isArray:!0}})}).directive("destinosAutocomplete",["$templateCache",function($templateCache){return{restrict:"AE",scope:{model:"=",selected:"=?",settings:"=?"},templateUrl:"template.html",controller:"DestinosAutocompleteCtrl"}}]).controller("DestinosAutocompleteCtrl",["$scope","ApiDestinos","$q",function($scope,ApiDestinos,$q){function getCiudades(name){return ApiDestinos.cities({query:name}).$promise.then(function(res){return res.filter(function(i){return i.Country}).map(function(item){return Object.assign({},item,{name:item.name+", "+item.Country.name,value:item.id,label:item.name})})})}function getPaises(name){return ApiDestinos.countries({query:name}).$promise.then(function(res){return res.map(function(item){return Object.assign({},item,{value:item.id,label:item.name})})})}function getCompletos(name){return ApiDestinos.autocompleteFull({query:name}).$promise.then(function(results){return results.map(function(item){return Object.assign({},item,{value:item.id,label:item.name})})})}function getAeropuertos(name){return ApiDestinos.airports({query:name}).$promise.then(function(res){return res.map(function(item){return Object.assign({},item,{name:item.name+", "+(item.Country?item.Country.name:item.City.name),value:item.id,label:item.name})})})}$scope.selected=$scope.selected||"",$scope.model=$scope.selected,$scope.defaults={placeholder:"Ingresá 3 letras y seleccioná del listado",emptyBtn:!1,destino:"ciudades",iata:!1,isArray:!1,emptyAfterSelect:!1,onSelect:null},$scope.defaults=angular.merge($scope.defaults,$scope.settings);switch($scope.defaults.destino){case"ciudades":$scope.getDestinos=getCiudades;break;case"paises":$scope.getDestinos=getPaises;break;case"completos":$scope.getDestinos=getCompletos;break;case"aeropuertos":$scope.getDestinos=getAeropuertos}$scope.vaciar=function(){$scope.model=null,$scope.selected=""},$scope.onSelect=function(data){if(!data)return!1;1==$scope.defaults.isArray?($scope.model.push(data),$scope.selected=""):($scope.defaults.emptyAfterSelect&&($scope.selected=""),$scope.model=data),setTimeout(function(){$scope.defaults.onSelect&&$scope.$parent[$scope.defaults.onSelect](data)},10)}}]).factory("destinosHttpInterceptor",["$q","$rootScope",function($q,$rootScope){return{request:function(config){return delete config.headers.ajaxLoader,config||$q.when(config)}}}]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push("destinosHttpInterceptor")}]);
!function(t){try{t=angular.module("Gdo")}catch(n){t=angular.module("Gdo",[])}t.run(["$templateCache",function(t){t.put("template.html",'<div class="input-group">\n\t<input\n\t\ttype="text"\n\t\tng-model="selected"\n\t\tplaceholder="{{defaults.placeholder}}"\n\t\tuib-typeahead="n as n.label for n in getDestinos($viewValue)"\n\t\ttypeahead-loading="loading"\n\t\ttypeahead-no-results="noResults"\n\t\tclass="form-control"\n\t\ttypeahead-min-length="3"\n\t\ttypeahead-on-select="onSelect($item, $model, $label, $event)"\n\t\ttypeahead-wait-ms="200"\n\t\ttypeahead-template-url="customTemplate.html"\n\t/>\n\t<span class="input-group-btn">\n\t\t<button class="btn btn-default" type="button" ng-show="loading">\n\t\t\t<i class="fa fa-refresh fa-spin"></i>\n\t\t</button>\n\t\t<button class="btn btn-default" type="button" ng-show="!loading" ng-click="vaciar()" ng-disabled="!defaults.emptyBtn">\n\t\t\t<i class="fa fa-times"></i>\n\t\t</button>\n  </span>\n</div>')}])}(),function(t){try{t=angular.module("Gdo")}catch(n){t=angular.module("Gdo",[])}t.run(["$templateCache",function(t){t.put("customTemplate.html","<a>\n  <i class=\"fa \" ng-class=\"{'fa-map-marker': match.model.type === 'CITY', 'fa-globe': match.model.type === 'COUNTRY', 'fa-plane': match.model.type === 'AIRPORT'}\"></i> &nbsp;\n  <span ng-bind-html=\"match.label | uibTypeaheadHighlight:query\"></span>\n</a>")}])}();